<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PsiTabs</title>
  <link rel="stylesheet" href="../css/global.css">
  <link rel="stylesheet" href="../css/sidepanel.css">
</head>
<body>
  <div class="container">
    <header>
      <h1>PsiTabs</h1>
      <div class="actions">
        <button id="theme-toggle-btn" title="Toggle theme">
          <svg id="light-theme-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="5"></circle>
            <line x1="12" y1="1" x2="12" y2="3"></line>
            <line x1="12" y1="21" x2="12" y2="23"></line>
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
            <line x1="1" y1="12" x2="3" y2="12"></line>
            <line x1="21" y1="12" x2="23" y2="12"></line>
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
          </svg>
          <svg id="dark-theme-icon" style="display: none;" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
          </svg>
        </button>
        <button id="options-btn" title="Settings">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="3"></circle>
            <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
          </svg>
        </button>
      </div>
    </header>

    <nav class="tab-nav">
      <div class="nav-item active" data-tab="all-tabs">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polygon points="12 2 2 7 12 12 22 7 12 2"></polygon>
          <polyline points="2 17 12 22 22 17"></polyline>
          <polyline points="2 12 12 17 22 12"></polyline>
        </svg>
        <span>Tabs</span>
      </div>
      <div class="nav-item" data-tab="groups">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect x="3" y="3" width="7" height="7"></rect>
          <rect x="14" y="3" width="7" height="7"></rect>
          <rect x="14" y="14" width="7" height="7"></rect>
          <rect x="3" y="14" width="7" height="7"></rect>
        </svg>
        <span>Groups</span>
      </div>
      <div class="nav-item" data-tab="duplicates">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
          <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
        </svg>
        <span>Duplicates</span>
      </div>
      <div class="nav-item" data-tab="ai">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
          <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>
          <line x1="12" y1="22.08" x2="12" y2="12"></line>
        </svg>
        <span>AI</span>
      </div>
    </nav>

    <div class="tab-content">
      <!-- All Tabs Tab -->
      <div class="content-panel active" id="all-tabs-panel">
        <div class="panel-header">
          <h2>All Tabs</h2>
          <div class="actions">
            <button id="refresh-tabs-btn" title="Refresh tabs">
              <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polyline points="1 4 1 10 7 10"></polyline>
                <polyline points="23 20 23 14 17 14"></polyline>
                <path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"></path>
              </svg>
            </button>
          </div>
        </div>

        <div class="panel-toolbar">
          <div class="search-container">
            <input type="text" id="search-tabs" placeholder="Search tabs...">
            <button id="clear-search" class="clear-button">Ã—</button>
          </div>

          <div class="toolbar-actions">
            <select id="sort-tabs" title="Sort tabs">
              <option value="default">Sort: Default</option>
              <option value="title">Sort: Title</option>
              <option value="url">Sort: URL</option>
              <option value="recent">Sort: Recent</option>
            </select>
          </div>
        </div>

        <div class="window-tabs-container">
          <!-- Windows and their tabs will be loaded here dynamically -->
          <div class="loading">Loading tabs...</div>
        </div>
      </div>

      <!-- Groups Tab -->
      <div class="content-panel" id="groups-panel">
        <div class="panel-header">
          <h2>Tab Groups</h2>
          <div class="actions">
            <button id="create-group-btn" title="Create new group">
              <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
              </svg>
            </button>
          </div>
        </div>

        <div class="panel-toolbar">
          <button id="group-by-domain-btn" class="action-button">Group by Domain</button>
          <button id="auto-group-btn" class="action-button">Auto Group (AI)</button>
        </div>

        <div class="groups-container">
          <!-- Groups will be loaded here dynamically -->
          <div class="loading">Loading groups...</div>
        </div>
      </div>

      <!-- Duplicates Tab -->
      <div class="content-panel" id="duplicates-panel">
        <div class="panel-header">
          <h2>Duplicate Tabs</h2>
          <div class="actions">
            <button id="scan-duplicates-btn" title="Scan for duplicates">
              <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="11" cy="11" r="8"></circle>
                <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
              </svg>
            </button>
          </div>
        </div>

        <div class="panel-toolbar">
          <button id="merge-all-btn" class="action-button" disabled>Merge All Duplicates</button>
        </div>

        <div class="duplicates-container">
          <div class="empty-state">
            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
              <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
              <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
            </svg>
            <p>Click "Scan" to find duplicate tabs</p>
          </div>
        </div>
      </div>

      <!-- AI Tools Tab -->
      <div class="content-panel" id="ai-panel">
        <div class="panel-header">
          <h2>AI Tools</h2>
        </div>

        <div class="ai-status">
          <div class="ai-status-indicator">
            <div class="status-icon not-configured"></div>
            <div class="status-text">LLM Status: <span id="llm-status">Not Configured</span></div>
          </div>
          <button id="configure-ai-btn" class="action-button">Configure</button>
        </div>

        <div class="ai-tools-container">
          <div class="ai-tool-card">
            <h3>Summarize Current Tab</h3>
            <p>Generate a concise summary of the content on the current tab.</p>
            <button id="summarize-current-btn" class="action-button" disabled>Summarize</button>
          </div>

          <div class="ai-tool-card">
            <h3>Group Tabs by Topic</h3>
            <p>Analyze open tabs and organize them into topic-based groups.</p>
            <button id="group-by-topic-btn" class="action-button" disabled>Group Tabs</button>
          </div>

          <div class="ai-tool-card">
            <h3>Generate Research Report</h3>
            <p>Create a report summarizing content from multiple selected tabs.</p>
            <button id="generate-report-btn" class="action-button" disabled>Generate Report</button>
          </div>
        </div>
      </div>
    </div>

    <div class="status-bar">
      <div id="status-message"></div>
      <div class="tab-count">
        <span id="total-tabs-count">0</span> tabs
      </div>
    </div>
  </div>

  <div id="modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="modal-title">Title</h2>
        <button class="close-modal">&times;</button>
      </div>
      <div class="modal-body" id="modal-body">
        <!-- Modal content will be dynamically added here -->
      </div>
    </div>
  </div>

  <script src="../js/sidepanel.js" type="module"></script>
</body>
</html>